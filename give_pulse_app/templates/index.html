{% extends "base.html" %}
{% load static %}

{% block title %}Home - GivePulse{% endblock %}

{% block content %}
<!-- Hero Section -->
<section id="home" class="hero py-5">
  <div class="container text-center">
    <h1 class="animate__animated animate__fadeInDown animate__slow mb-3">
      Connecting Blood Donors with Urgent Requests
    </h1>
    <p class="animate__animated animate__fadeInUp animate__delay-1s text-muted">
      A real-time platform designed to reduce waiting times, match urgent requests,
      and build a strong community committed to saving lives
    </p>
    <div class="mt-4 animate__animated animate__zoomIn animate__delay-2s">
      <a href="{% url 'register_donor' %}" class="btn btn-secondary-custom btn-lg me-3">Register as Donor</a>
      <a href="{% url 'register_staff' %}" class="btn btn-secondary-custom btn-lg me-3">Register as Staff</a>
    </div>
  </div>
</section>

<!-- Leaderboard Section -->
<section class="leaderboard py-5 bg-light">
  <div class="container">
    <h2 class="text-primary-red text-center mb-4 animate__animated animate__fadeInUp"> Leaderboard</h2>
    <div class="row">
      <div class="col-md-6 mb-4 animate__animated animate__fadeInLeft animate__delay-1s">
        <table class="table table-hover text-center shadow-sm">
          <thead class="table-success">
            <tr>
              <th>Rank</th>
              <th>Donor Name</th>
              <th>Donations Count</th>
              <th>City</th>
            </tr>
          </thead>
          <tbody>
            {% if leaderboard %}
              {% for donor in leaderboard %}
                <tr>
                  <td>{{ donor.rank }}</td>
                  <td>{{ donor.name }}</td>
                  <td>{{ donor.donation_count }}</td>
                  <td>{{ donor.city }}</td>
                </tr>
              {% endfor %}
            {% else %}
              <tr>
                <td colspan="4" class="text-center text-muted">No donation data available yet</td>
              </tr>
            {% endif %}
          </tbody>
        </table>
      </div>
      <div
  class="col-md-6 mb-4 d-flex align-items-center justify-content-center animate__animated animate__fadeInRight animate__delay-2s">
  <canvas id="donationsChart"></canvas>
</div>

    </div>
  </div>
</section>

<!-- about Section -->
<section class="about py-5" id="about">
  <div class="container text-center animate__animated animate__fadeInUp animate__delay-1s">
    <h2 class="text-primary-red mb-3">About Us</h2>
    <p class="lead">
      GivePulse is an innovative platform designed to connect
      <span class="text-primary-red fw-bold">blood donors</span>
      with hospitals and patients in urgent need. We reduce waiting times,
      raise awareness about blood donation, and build a caring community
      committed to saving lives.
    </p>
    <a href="{% url 'about' %}" class="btn btn-secondary-custom mt-3 nimate__infinite">Learn More</a>
  </div>
</section>

<!-- Success Stories Section -->
<section class="success-stories py-5 bg-light" id="success">
  <div class="container">
    <h2 class="text-primary-red text-center mb-5 animate__animated animate__fadeInDown">Success Stories</h2>
    
    {% if success_stories %}
      <div class="stories-carousel-container">
        <!-- Navigation Buttons -->
        <button class="carousel-nav-btn prev-btn" id="prevBtn" onclick="moveCarousel(-1)">
          <i class="bi bi-chevron-left"></i>
        </button>
        
        <button class="carousel-nav-btn next-btn" id="nextBtn" onclick="moveCarousel(1)">
          <i class="bi bi-chevron-right"></i>
        </button>
        
        <!-- Stories Carousel -->
        <div class="stories-carousel" id="storiesCarousel">
          <div class="stories-track" id="storiesTrack">
            {% for story in success_stories %}
              <div class="story-item">
                <div class="card h-100 shadow-sm border-0">
                  <div class="card-body text-center">
                    {% if story.image_url %}
                      <img src="{{ story.image_url }}" alt="{{ story.donor_name }}" class="story-image rounded-circle mb-3">
                    {% else %}
                      <img src="https://i.pravatar.cc/80?img={{ forloop.counter }}" alt="{{ story.donor_name }}" class="story-image rounded-circle mb-3">
                    {% endif %}
                    <h5 class="text-secondary-green mb-3">{{ story.title }}</h5>
                    <p class="story-text mb-0">{{ story.story_text }}</p>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
        
        <!-- Dots Indicator -->
        <div class="carousel-dots" id="carouselDots">
          {% for story in success_stories %}
            <span class="dot {% if forloop.first %}active{% endif %}" onclick="goToSlide({{ forloop.counter0 }})"></span>
          {% endfor %}
        </div>
      </div>
    {% else %}
      <div class="text-center">
        <p class="text-muted">No success stories available yet.</p>
      </div>
    {% endif %}
  </div>
</section>
<!-- charts library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<!-- linking charts javascript -->
<script src="{% static 'js/charts.js' %}"></script>
<!-- Success Stories Slider JavaScript -->
<script src="{% static 'js/success-stories-slider.js' %}"></script>

{% endblock %}